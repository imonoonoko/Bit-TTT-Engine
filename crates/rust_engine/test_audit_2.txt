**********************************************************************
** Visual Studio 2022 Developer Command Prompt v17.14.23
** Copyright (c) 2025 Microsoft Corporation
**********************************************************************
[vcvarsall.bat] Environment initialized for: 'x64'
warning: cortex_rust@0.1.0: Successfully compiled CUDA kernel to "C:\\Users\\Humin\\.gemini\\antigravity\\scratch\\new-ai-project\\Bit-TTT\\target\\debug\\build\\cortex_rust-e7e45ff7e898356d\\out\\bit_op.ptx"
   Compiling cortex_rust v0.1.0 (C:\Users\Humin\.gemini\antigravity\scratch\new-ai-project\Bit-TTT\crates\rust_engine)
warning: unused import: `DType`
 --> crates\rust_engine\tests\grad_test.rs:4:39
  |
4 |     use candle_core::{Device, Tensor, DType, Result};
  |                                       ^^^^^
  |
  = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: unused import: `candle_nn::VarBuilder`
 --> crates\rust_engine\tests\bit_linear_test.rs:5:9
  |
5 |     use candle_nn::VarBuilder;
  |         ^^^^^^^^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: variable does not need to be mutable
  --> crates\rust_engine\tests\grad_test.rs:67:13
   |
67 |         let mut grads_ref = loss_ref.backward()?;
   |             ----^^^^^^^^^
   |             |
   |             help: remove this `mut`
   |
   = note: `#[warn(unused_mut)]` (part of `#[warn(unused)]`) on by default

warning: variable does not need to be mutable
   --> crates\rust_engine\tests\grad_test.rs:122:13
    |
122 |         let mut grads_custom = loss_custom.backward()?;
    |             ----^^^^^^^^^^^^
    |             |
    |             help: remove this `mut`

warning: unused variable: `x_var`
  --> crates\rust_engine\tests\grad_test.rs:35:13
   |
35 |         let x_var = candle_core::Var::from_tensor(&x)?;
   |             ^^^^^ help: if this is intentional, prefix it with an underscore: `_x_var`
   |
   = note: `#[warn(unused_variables)]` (part of `#[warn(unused)]`) on by default

warning: unused variable: `dw_ref`
  --> crates\rust_engine\tests\grad_test.rs:69:13
   |
69 |         let dw_ref = grads_ref.get(&w_var).unwrap();
   |             ^^^^^^ help: if this is intentional, prefix it with an underscore: `_dw_ref`

warning: unused variable: `y_custom`
  --> crates\rust_engine\tests\grad_test.rs:83:13
   |
83 |         let y_custom = x_t.apply_op2(w_t, (*op).clone())?;
   |             ^^^^^^^^ help: if this is intentional, prefix it with an underscore: `_y_custom`

warning: `cortex_rust` (test "grad_test") generated 6 warnings (run `cargo fix --test "grad_test" -p cortex_rust` to apply 6 suggestions)
warning: `cortex_rust` (test "bit_linear_test") generated 1 warning (run `cargo fix --test "bit_linear_test" -p cortex_rust` to apply 1 suggestion)
    Finished `test` profile [unoptimized + debuginfo] target(s) in 8.66s
     Running unittests src\lib.rs (C:\Users\Humin\.gemini\antigravity\scratch\new-ai-project\Bit-TTT\target\debug\deps\cortex_rust-a9a826658527e88c.exe)

running 4 tests
test kernels::packing::tests::test_packing_manual ... ok
test kernels::packing::tests::test_packing_padding ... ok
test kernels::packing::tests::test_packing_cycle_dense ... ok
test kernels::packing::tests::test_packing_cycle_sparse ... ok

test result: ok. 4 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src\bin\bench_cpu_kernel.rs (C:\Users\Humin\.gemini\antigravity\scratch\new-ai-project\Bit-TTT\target\debug\deps\bench_cpu_kernel-7528e620f3bdee36.exe)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running unittests src\bin\test_memory.rs (C:\Users\Humin\.gemini\antigravity\scratch\new-ai-project\Bit-TTT\target\debug\deps\test_memory-4a3856a6dd3571fd.exe)

running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s

     Running tests\bit_linear_test.rs (C:\Users\Humin\.gemini\antigravity\scratch\new-ai-project\Bit-TTT\target\debug\deps\bit_linear_test-d75e1de156ac416c.exe)

running 1 test
test cuda_tests::test_bit_linear_correctness ... FAILED

failures:

---- cuda_tests::test_bit_linear_correctness stdout ----
Running test on CUDA device: Cuda(CudaDevice(DeviceId(1)))
Error: BitLinearCuda: Out_features (n=2) must be divisible by 4 for backward packing


failures:
    cuda_tests::test_bit_linear_correctness

test result: FAILED. 0 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out; finished in 1.68s

error: test failed, to rerun pass `--test bit_linear_test`
